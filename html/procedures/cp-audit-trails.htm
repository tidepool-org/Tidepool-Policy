<h3>Audit Trails and Application Security Events Logging Standard</h3>
<p>Tidepool logging standards requires application and system logs to contain
sufficient information to determine <strong>who did what, when, where</strong> to ensure
recording of security and audit events and to generate evidence for unauthorized
activities.</p>
<p>All systems and software developed at Tidepool must have the following security
events logging enabled as part of or in addition to standard application
logging.</p>
<ol>
<li>
<p>All security log events must have the following attributes at minimum:</p>
<ul>
<li>
<p>Timestamp of the event (synchronized to approved time server)</p>
</li>
<li>
<p>Identifier of the principal performing the action (such as user ID)</p>
</li>
<li>
<p>Location including both origin (such as hostname/IP) and target (such as
host/service/resource)</p>
</li>
<li>
<p>Activity or action (such as log in, log out, create, read, update, delete
of a resource)</p>
<ul>
<li>the action may be logged as and determined by the HTTP request method
and the API endpoint </li>
</ul>
</li>
<li>
<p>Event description and additional details may be logged depending on the
system or application </p>
</li>
</ul>
</li>
<li>
<p>The following types of security events must be logged at minimum:</p>
<ul>
<li>User and group administration activities (user or group added, updated,
deleted, access granted/revoked)</li>
<li>All login attempts, successful and unsuccessful including the source IP
address</li>
<li>All interactive logoffs</li>
<li>Privileged actions (configuration changes, application shutdown/restart,
software update etc)</li>
<li>Major application events (e.g. application failure, start and restart,
shutdown)</li>
<li>Any and all actions performed on critical resources such as production
data</li>
</ul>
</li>
<li>
<p>All application and system logs must not include (removed or masked):</p>
<ul>
<li>
<p>Any sensitive information, including
protected health information (PHI),
personally identifiable information (PII)</p>
<ul>
<li>except for IP addresses</li>
<li>usernames/logins may/should be logged as part of authentication logging</li>
<li>for user action auditing, opaque IDs should be used instead of
usernames/logins whenever possible</li>
</ul>
</li>
<li>
<p>Authentication and session tokens, user credentials</p>
</li>
</ul>
</li>
<li>
<p>Security events and audit logs must be:</p>
<ul>
<li>Always accessible to the monitoring system/team</li>
<li>Protected from any changes</li>
<li>Monitored with alerting mechanism in place (including alert for not
receiving log events for a certain period of time)</li>
</ul>
</li>
<li>
<p>All Tidepool IT infrastructure must have system clock synchronized</p>
</li>
</ol>
<p><em>Examples of recommended application events for logging and their auditing purpose:</em></p>
<table>
<thead>
<tr>
<th>Events</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Client requests and server responses</td>
<td>forensics and debugging - details level is defined by application</td>
</tr>
<tr>
<td>Successful and unsuccessful login attempts</td>
<td>authentication</td>
</tr>
<tr>
<td>Successful and failed access to application resources</td>
<td>authorization, escalation of privileges</td>
</tr>
<tr>
<td>Excessive amount of requests from the client</td>
<td>brute-forcing, malicious bots, denial of service attacks</td>
</tr>
<tr>
<td>E-mails sent by an application</td>
<td>spamming, social engineering</td>
</tr>
</tbody>
</table>
<p><em>Details of the logging configuration is documented at</em></p>
<ul>
<li><a href="https://tidepool.atlassian.net">Application Logging - documented on the Engineering Wiki</a></li>
<li><a href="https://developer.okta.com/docs/api/resources/system_log">Identity and Access Activity Logs via Okta</a></li>
<li><a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-examples.html">AWS Cloudtrail</a></li>
<li><a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html">AWS S3 Server Access Logs</a></li>
</ul>